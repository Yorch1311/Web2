"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.contentRenderPlugin = void 0;
const pluginRepository_1 = require("../pluginManagement/pluginRepository");
const log_1 = require("../utils/log");
const convertAndInjectContent_1 = require("./content-render-utils/convertAndInjectContent");
const readFileAndCheckPrePublishSlug_1 = require("./content-render-utils/readFileAndCheckPrePublishSlug");
pluginRepository_1.registerPlugin('postProcessByDom', 'contentFolder', contentRenderPlugin);
async function contentRenderPlugin(dom, route) {
    const file = route.templateFile;
    try {
        const extension = file.split('.').pop();
        const { fileContent } = await readFileAndCheckPrePublishSlug_1.readFileAndCheckPrePublishSlug(file);
        return convertAndInjectContent_1.convertAndInjectContent(dom, fileContent, extension, route);
    }
    catch (e) {
        log_1.logWarn(`Error, while rendering content for "${log_1.yellow(route.route)}" from file: "${log_1.yellow(file)}"`);
        console.error(e);
    }
    return dom;
}
exports.contentRenderPlugin = contentRenderPlugin;
//# sourceMappingURL=contentRenderPlugin.js.map